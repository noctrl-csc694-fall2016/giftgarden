<% provide(:title, "Surf Gifts") %>
<div class="row">
  <div class="col-sm-8 col-xs-offset-2">
  	<div class="page-header">
  		<h2>Surf Gifts <small>&nbsp; Select a row to view or edit that gift.</small></h2>
  		<aside class="text-right">
  		  <%= link_to(new_gift_path) do %>
			    <span class="glyphicon glyphicon-plus icon-donna icon-donna-new"></span><span class="icon-donna-text">New Gift</span>
		    <% end %>
  		  <div>
          		<%=link_to "All Activities", activities_url %>&nbsp; | &nbsp;<%=link_to "All Donors", donors_url %>
        </div>
  		</aside>
  	</div>
  </div>
</div>

<!--dropdown for activity and donor-->
<div class="row">
  <%= render 'search_form' %>
</div>

<!--Table -- list all requested gifts-->
<div class="row">
  <div class="col-sm-8 col-xs-offset-2">
    <% if @gifts.count != 0 %>
    <div class="row surf-data">
      There are <%= pluralize(@gifts.count, "gift") %> for a sum of <%= number_to_currency(Gift.sum(:amount)) %>.
    </div>
    <table class="table table-striped table-hover table-bordered table-responsive">
      <thead>
        <tr>
          <td>Donor</td>
          <td>Date</td>
          <td>Activity</td>
          <td>Amount</td>
          <td>Type</td>
        </tr>
      </thead>
      <tbody>
        <% @gifts.each do |gift| %>
        <!--find the gifts that match the selected activity and donor-->
          <% if ((params[:activity_id] == "" || params[:activity_id] == gift.activity_id.to_s ) && (params[:donor_id] == "" || params[:donor_id] == gift.donor_id.to_s)) %>
          <tr data-link="<%= edit_gift_path(gift) %>">
            <td><%= Donor.find(gift.donor).first_name + " " + Donor.find(gift.donor).last_name %></td>
            <td><%= gift.donation_date.strftime("%B %d, %Y") %></td>
            <td><%= Activity.find(gift.activity).name %></td>
            <td><%= number_to_currency(gift.amount) %></td>
            <td><%= gift.gift_type %></td>
          </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
    <% else %>
    <h3>No gifts located given your search criteria.</h3>
    <% end %>
  </div>
</div>